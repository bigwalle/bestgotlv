package BestGoTlv

import (
  "encoding/hex"
	"testing"
)

func TestParse(t *testing.T) {

	hexData := `7f3e8205bd7f228201b4308201b030820155a0030201020215008415871ce2fc912fc02e987736974dff04a7e470300a06082a8648ce3d04030230173115301306035504030c0c584d2d524f4f542d43412d45301e170d3231303630343130333031335a170d3231303730343130333031335a300f310d300b06035504030c0447454c593059301306072a8648ce3d020106082a8648ce3d030107034200049509e2af9efcc3dd92d2bd58583073b8dea3b5f7f464a7cacbf71259f3fed31bd0209dbe5d5f17ee5745d0258dfabbc8ba154644720d3f56dcc0576abe825ae6a38185308182300e0603551d0f0101ff04040302020430120603551d130101ff040830060101ff020100301f0603551d23041830168014b2d0b1ebb40a7b888ed18dcb8d4dd57cf527cbf7301d0603551d0e04160414909cf8101dc9fdee80fbb1b328d02227e7979264301c060a2b0601040182c46905030101ff040b3009a00702010104023030300a06082a8648ce3d04030203490030460221008f2ba8f2c64f32eaba9d3400fcfb56d5e448f2b3f14ab9b845529226452415f1022100dc7889697a3950b2d0e9549287a989efb93a5e7888f6ce1fc935e7c3436947357f2482020c30820208308201afa00302010202080ae82021e9500185300a06082a8648ce3d040302300f310d300b0603550403130447454c593020170d3230303130313030303030305a180f39393939313233313233353935395a30233121301f060355040313184449474b2e4f574e522e583844307c4c6f747573454344483059301306072a8648ce3d020106082a8648ce3d03010703420004bac3fafb09bc928f5a22d9505660da026f852b3021ce545a2cab845b970fc905a86dd81e30f1e6a83689135479b2f5f63b4a3727959613afb8aa7302464850f9a381de3081db308196060a2b0601040182c46905040101ff0481843081810201010408424f47484b4351540401cf04017d040201003050300a06082a8648ce3d03010703420004c32f4b7c684a6735f2167b6bbbf3b526b6d1d45623adf6a2c234de72011e20ca911502aada343cdbf8c1ad3296e71e3c5a427d5fc0e70a0ffa78e7e82c334842040101a00402020200a10402020200a207020500ffffffff300e0603551d0f0101ff040403020780300c0603551d130101ff0402300030220603551d23010100041830168014909cf8101dc9fdee80fbb1b328d02227e7979264300a06082a8648ce3d0403020347003044022009718af94dfcc5cab8db60f4b246527cac6f91d9e0c47e59a060213cf3026dc9022070cb1274531ab3824ac244a80c5f2f5be5fbbaf956122bea54dadd705d1263acd58201963082019230820136a003020102020723425353464564300c06082a8648ce3d0403020500302b3129302706035504031320562e4e58502e4155542e4252414e442e383838383838383838383838383838383022180f32303230303433303231313530375a180f32303232303433303231313530375a3020311e301c06035504031315656e64706f696e745f7375626a6563745f6e616d653059301306072a8648ce3d020106082a8648ce3d0301070342000484ed7f70f0a81bbe1b4aae2de4c527963d4d3012c4c0748c8309929902af99a54e6e169a417ca26b14345d4858ea3308c4f274ef53ab04bb3f89effc18d94581a34a30483046060a2b0601040182c469050201010004353033042432356330643931642d623866322d343439382d393137352d346430353737666133396437040b7777772e6e78702e636f6d300c06082a8648ce3d04030205000348003045022100cd8ebd7c1ed5d932f8baa78675910f50fea8137e70334a738f895d24ad43d84c02205f84031971c785607dc5a3dbf4e7d80ac0f390f8835b3e6c5f3a4ffcb4c448f6d3094c6f747573454344485f4941045ae096022fda9ab84cd83da987d8e2b69b3d0e490c43eb34a5cb0da7fc87b17c97675295b646332ce4adc2f0fa0c1865ba4b5847ff555f7247df64a9a1d885aada0845434945535f7631`
	bytedata, _ := hex.DecodeString(hexData)
	tlvs := NewBerTlvParser().Parse(bytedata)
	tlv := tlvs.Find(NewBerTagFirstByte(0xDA))

	tlv2 := tlvs.Find(NewBerTagFirstByte(0xD5))

	tlv3 := tlvs.Find(NewBerTagFirstByte(0xD3))

	tlv4 := tlvs.Find(BerTag{Bytes: []byte{0x5f, 0x49}})
	t.Log(tlv.GetTextValue())
	t.Log(tlv2.GetHexValue())
	t.Log(tlv3.GetTextValue())
	t.Log(tlv4.GetHexValue())

	t.Log(tlvs)
}
